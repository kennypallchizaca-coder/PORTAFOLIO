import{u as R,r,j as e}from"./index-Bn63hJ9p.js";import{l as F,h as D,i as A}from"./firestore-COAHH7ud.js";import{w as B}from"./index-u9cVwM0c.js";const p={title:"",description:"",category:"academico",role:"frontend",techStack:"",repoUrl:"",demoUrl:"",imageUrl:""},z=()=>{const{user:i}=R(),[g,b]=r.useState([]),[s,d]=r.useState(p),[n,m]=r.useState(null),[N,f]=r.useState(!1),[v,h]=r.useState(""),[y,x]=r.useState(""),[U,w]=r.useState(null),[S,u]=r.useState(""),j=r.useCallback(async()=>{if(i?.uid)try{const a=await F(i.uid);b(a)}catch(a){console.error("Error al cargar proyectos:",a),x("No se pudieron cargar los proyectos."),b([])}},[i?.uid]);r.useEffect(()=>{j()},[j]);const o=a=>{const{name:l,value:t}=a.target;d(c=>({...c,[l]:t}))},k=a=>{const l=a.target.files?.[0];if(l){w(l);const t=new FileReader;t.onloadend=()=>{u(t.result)},t.readAsDataURL(l)}},C=async a=>{a.preventDefault(),f(!0),h(""),x("");try{const l={title:s.title,description:s.description,category:s.category,role:s.role,techStack:s.techStack.split(",").map(c=>c.trim()).filter(Boolean),repoUrl:s.repoUrl,demoUrl:s.demoUrl,imageUrl:""};let t=n;if(n)await D(n,l),h("Proyecto actualizado.");else{if(!i?.uid)throw new Error("Usuario no autenticado");t=(await A(i.uid,l)).id,h("Proyecto creado.")}if(U&&t){console.log("ðŸ“¸ Guardando imagen en localStorage con ID:",t);const c=new FileReader;await new Promise(E=>{c.onloadend=()=>{const I=c.result;localStorage.setItem(`project_img_${t}`,I),console.log("âœ… Imagen guardada en localStorage"),E()},c.readAsDataURL(U)})}d(p),m(null),w(null),u(""),await j()}catch(l){console.error("Error al guardar proyecto:",l),x("No se pudo guardar el proyecto.")}finally{f(!1)}},P=a=>{m(a.id),d({title:a.title,description:a.description,category:a.category,role:a.role,techStack:a.techStack?.join(", ")||"",repoUrl:a.repoUrl||"",demoUrl:a.demoUrl||"",imageUrl:a.imageUrl||""}),u(a.imageUrl||"")};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Proyectos"}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsx("form",{onSubmit:C,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:n?"Editar proyecto":"Nuevo proyecto"}),n&&e.jsx("button",{type:"button",className:"btn btn-ghost btn-xs",onClick:()=>{m(null),d(p)},children:"Cancelar"})]}),v&&e.jsx("div",{className:"alert alert-success text-sm",children:v}),y&&e.jsx("div",{className:"alert alert-error text-sm",children:y}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"TÃ­tulo *"})}),e.jsx("input",{name:"title",value:s.title,onChange:o,className:"input input-bordered",required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"DescripciÃ³n"})}),e.jsx("textarea",{name:"description",value:s.description,onChange:o,className:"textarea textarea-bordered",rows:3})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"CategorÃ­a"})}),e.jsxs("select",{name:"category",value:s.category,onChange:o,className:"select select-bordered",children:[e.jsx("option",{value:"academico",children:"AcadÃ©mico"}),e.jsx("option",{value:"laboral",children:"Laboral"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Rol"})}),e.jsxs("select",{name:"role",value:s.role,onChange:o,className:"select select-bordered",children:[e.jsx("option",{value:"frontend",children:"Frontend"}),e.jsx("option",{value:"backend",children:"Backend"}),e.jsx("option",{value:"fullstack",children:"Fullstack"}),e.jsx("option",{value:"db",children:"Base de datos"})]})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"TecnologÃ­as (coma)"})}),e.jsx("input",{name:"techStack",value:s.techStack,onChange:o,className:"input input-bordered",placeholder:"React, Firebase, Tailwind"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Imagen del proyecto"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[S&&e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-32 rounded",children:e.jsx("img",{src:S,alt:"Preview"})})}),e.jsxs("label",{className:"btn btn-outline btn-sm gap-2 w-fit",children:[e.jsx(B,{}),"Seleccionar imagen",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:k})]})]})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Repo"})}),e.jsx("input",{name:"repoUrl",value:s.repoUrl,onChange:o,className:"input input-bordered",placeholder:"https://github.com/..."})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Demo"})}),e.jsx("input",{name:"demoUrl",value:s.demoUrl,onChange:o,className:"input input-bordered",placeholder:"https://app..."})]})]}),e.jsx("div",{className:"card-actions justify-end",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:N,children:N?"Guardando...":n?"Actualizar proyecto":"Crear proyecto"})})]})}),e.jsxs("div",{className:"space-y-2",children:[g.map(a=>e.jsx("div",{className:"card bg-base-100 shadow-sm",children:e.jsxs("div",{className:"card-body space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:a.title}),e.jsxs("p",{className:"text-xs text-base-content/60",children:[a.category," Â· ",a.role]})]}),e.jsx("button",{className:"btn btn-ghost btn-xs",onClick:()=>P(a),children:"Editar"})]}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.description}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.techStack?.map(l=>e.jsx("span",{className:"badge badge-ghost",children:l},l))}),e.jsxs("div",{className:"card-actions justify-end",children:[a.repoUrl&&e.jsx("a",{className:"btn btn-outline btn-xs",href:a.repoUrl,target:"_blank",rel:"noreferrer",children:"CÃ³digo"}),a.demoUrl&&e.jsx("a",{className:"btn btn-primary btn-xs",href:a.demoUrl,target:"_blank",rel:"noreferrer",children:"Demo"})]})]})},a.id)),!g.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay proyectos."})]})]})]})};export{z as default};
