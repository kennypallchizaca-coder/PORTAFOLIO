import{u as M,r,g as R,d as w,e as o,j as e,N as I,T,h as L,i as U,k,l as G,m as B,s as z,n as O,o as $}from"./index-DxcVSFIQ.js";import{u as H,v as K,q as X,w as D,x as _,y as J,z as Q}from"./index-CeycBSpl.js";import{m as u}from"./proxy-Dzs7Ezcg.js";const Z=()=>{const{user:F}=M(),[p,C]=r.useState([]),[d,m]=r.useState(!1),[c,x]=r.useState(null),[g,b]=r.useState(!1),[j,N]=r.useState(null),[f,v]=r.useState(""),[s,i]=r.useState({title:"",description:"",imageUrl:"",githubUrl:"",demoUrl:"",technologies:"",teamMembers:""});r.useEffect(()=>{h()},[]);const h=async()=>{try{const l=(await R(w(o,"projects"))).docs.map(t=>({id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate()||new Date}));C(l.sort((t,n)=>n.createdAt.getTime()-t.createdAt.getTime()))}catch(a){console.error("Error fetching projects:",a)}},E=a=>{const l=a.target.files?.[0];if(l){N(l);const t=new FileReader;t.onloadend=()=>{v(t.result)},t.readAsDataURL(l)}},S=async a=>{const l=Date.now(),t=B(z,`projects/${l}_${a.name}`);return await O(t,a),await $(t)},P=async a=>{a.preventDefault(),b(!0);try{let l=s.imageUrl;j&&(l=await S(j));const t={title:s.title,description:s.description,imageUrl:l,githubUrl:s.githubUrl,demoUrl:s.demoUrl||"",technologies:s.technologies.split(",").map(n=>n.trim()).filter(Boolean),teamMembers:s.teamMembers.split(",").map(n=>n.trim()).filter(Boolean),createdAt:T.now()};c?await L(U(o,"projects",c),t):await k(w(o,"projects"),t),y(),h()}catch(l){console.error("Error saving project:",l),alert("Error al guardar el proyecto")}finally{b(!1)}},A=a=>{i({title:a.title,description:a.description,imageUrl:a.imageUrl,githubUrl:a.githubUrl,demoUrl:a.demoUrl||"",technologies:a.technologies.join(", "),teamMembers:a.teamMembers.join(", ")}),x(a.id),m(!0)},q=async a=>{if(confirm("¿Estás seguro de eliminar este proyecto?"))try{await G(U(o,"projects",a)),h()}catch(l){console.error("Error deleting project:",l),alert("Error al eliminar el proyecto")}},y=()=>{i({title:"",description:"",imageUrl:"",githubUrl:"",demoUrl:"",technologies:"",teamMembers:""}),N(null),v(""),x(null),m(!1)};return F?e.jsx("div",{className:"min-h-screen bg-base-200",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(u.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Administrar Proyectos"}),e.jsx("p",{className:"text-base-content/70",children:"Gestiona los proyectos del equipo"})]}),e.jsx("button",{onClick:()=>m(!d),className:"btn btn-primary gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-5 w-5"}),"Cancelar"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-5 w-5"}),"Nuevo Proyecto"]})})]}),d&&e.jsx(u.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"card bg-base-100 shadow-xl mb-8",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:c?"Editar Proyecto":"Nuevo Proyecto"}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Título *"})}),e.jsx("input",{type:"text",value:s.title,onChange:a=>i({...s,title:a.target.value}),className:"input input-bordered",required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"URL de GitHub *"})}),e.jsxs("div",{className:"join w-full",children:[e.jsx("span",{className:"join-item btn btn-disabled",children:e.jsx(X,{className:"h-5 w-5"})}),e.jsx("input",{type:"url",value:s.githubUrl,onChange:a=>i({...s,githubUrl:a.target.value}),className:"input input-bordered join-item w-full",placeholder:"https://github.com/...",required:!0})]})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Descripción *"})}),e.jsx("textarea",{value:s.description,onChange:a=>i({...s,description:a.target.value}),className:"textarea textarea-bordered h-24",required:!0})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Imagen del Proyecto *"})}),e.jsxs("div",{className:"space-y-2",children:[(f||s.imageUrl)&&e.jsx("div",{className:"relative w-full h-48 rounded-lg overflow-hidden border-2 border-base-300",children:e.jsx("img",{src:f||s.imageUrl,alt:"Preview",className:"w-full h-full object-cover"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:E,className:"file-input file-input-bordered w-full"}),e.jsx("div",{className:"divider text-xs",children:"O"}),e.jsxs("div",{className:"join w-full",children:[e.jsx("span",{className:"join-item btn btn-disabled",children:e.jsx(D,{className:"h-5 w-5"})}),e.jsx("input",{type:"url",value:s.imageUrl,onChange:a=>i({...s,imageUrl:a.target.value}),className:"input input-bordered join-item w-full",placeholder:"O pega una URL de imagen"})]})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"URL Demo (opcional)"})}),e.jsx("input",{type:"url",value:s.demoUrl,onChange:a=>i({...s,demoUrl:a.target.value}),className:"input input-bordered",placeholder:"https://..."})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Tecnologías (separadas por coma) *"})}),e.jsx("input",{type:"text",value:s.technologies,onChange:a=>i({...s,technologies:a.target.value}),className:"input input-bordered",placeholder:"React, TypeScript, Firebase",required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Miembros del equipo (separados por coma) *"})}),e.jsx("input",{type:"text",value:s.teamMembers,onChange:a=>i({...s,teamMembers:a.target.value}),className:"input input-bordered",placeholder:"Kenny, Alexis, Daniel",required:!0})]})]}),e.jsxs("div",{className:"card-actions justify-end",children:[e.jsx("button",{type:"button",onClick:y,className:"btn btn-ghost",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary gap-2",disabled:g,children:g?e.jsx("span",{className:"loading loading-spinner"}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"h-5 w-5"}),c?"Actualizar":"Guardar"]})})]})]})]})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:p.map((a,l)=>e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1},className:"card bg-base-100 shadow-xl",children:[e.jsx("figure",{className:"h-48 bg-base-200",children:a.imageUrl?e.jsx("img",{src:a.imageUrl,alt:a.title,className:"h-full w-full object-cover"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx(D,{className:"h-16 w-16 text-base-content/30"})})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:a.title}),e.jsx("p",{className:"text-sm text-base-content/70 line-clamp-2",children:a.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:a.technologies.slice(0,3).map((t,n)=>e.jsx("span",{className:"badge badge-sm badge-primary badge-outline",children:t},n))}),e.jsxs("div",{className:"card-actions justify-end mt-4",children:[e.jsxs("button",{onClick:()=>A(a),className:"btn btn-sm btn-ghost gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>q(a.id),className:"btn btn-sm btn-error gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Eliminar"]})]})]})]},a.id))}),p.length===0&&e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-base-content/70",children:"No hay proyectos todavía"})})]})}):e.jsx(I,{to:"/login",replace:!0})};export{Z as default};
