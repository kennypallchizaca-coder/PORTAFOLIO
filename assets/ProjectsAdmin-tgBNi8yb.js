import{u as Y,r as i,g as Z,d as O,e as p,j as e,N as ee,T as ae,h as se,i as _,k as te,l as le,m as re,s as ie,n as ne,o as oe}from"./index-Dp-_kc_8.js";import{u as ce,v as w,q as de,w as z,x as U,y as me,z as ue}from"./index-BFeof-vj.js";import{F as o}from"./FormUtils-X4tq9MxD.js";import{m as D}from"./proxy-COU5OFf_.js";const Ne=()=>{const{user:K}=Y(),[C,$]=i.useState([]),[j,N]=i.useState(!1),[h,E]=i.useState(null),[F,T]=i.useState(!1),[A,S]=i.useState(null),[P,q]=i.useState(""),[c,m]=i.useState(["React","Firebase"]),[d,u]=i.useState(["Alexis"]),[g,y]=i.useState(""),[x,f]=i.useState(""),[l,n]=i.useState({title:"",description:"",imageUrl:"",githubUrl:"",demoUrl:"",category:"academico"}),[he,k]=i.useState({}),[ge,R]=i.useState({}),M={title:[a=>o.required(a),a=>o.minLength(a,3)],description:[a=>o.required(a),a=>o.minLength(a,10)],githubUrl:[a=>a&&o.url(a)],demoUrl:[a=>a&&o.url(a)]};i.useEffect(()=>{v()},[]);const v=async()=>{try{const t=(await Z(O(p,"projects"))).docs.map(s=>({id:s.id,...s.data(),createdAt:s.data().createdAt?.toDate()||new Date}));$(t.sort((s,r)=>r.createdAt.getTime()-s.createdAt.getTime()))}catch(a){console.error("Error fetching projects:",a)}},L=()=>{!g.trim()||g.length<2||(m([...c,g.trim()]),y(""))},B=a=>{m(c.filter((t,s)=>s!==a))},I=()=>{!x.trim()||x.length<3||(u([...d,x.trim()]),f(""))},H=a=>{u(d.filter((t,s)=>s!==a))},X=a=>{const t=a.target.files?.[0];if(t){S(t);const s=new FileReader;s.onloadend=()=>{q(s.result)},s.readAsDataURL(t)}},J=async a=>{const t=Date.now(),s=re(ie,`projects/${t}_${a.name}`);return await ne(s,a),await oe(s)},Q=async a=>{a.preventDefault();const t=Object.keys(M).reduce((r,b)=>(r[b]=!0,r),{});R(t);const s=o.validateForm(l,M);if(k(s),c.length<1&&(s.technologies="Debe tener al menos 1 tecnología"),d.length<1&&(s.teamMembers="Debe tener al menos 1 miembro del equipo"),o.hasErrors(s)){alert("Por favor corrige los errores en el formulario.");return}T(!0);try{let r=l.imageUrl;A&&(r=await J(A));const b={title:l.title,description:l.description,imageUrl:r,githubUrl:l.githubUrl,demoUrl:l.demoUrl||"",technologies:c,teamMembers:d,category:l.category,createdAt:ae.now()};h?await se(_(p,"projects",h),b):await te(O(p,"projects"),b),alert("✓ Proyecto guardado correctamente."),G(),v()}catch(r){console.error("Error saving project:",r),alert("Error al guardar el proyecto")}finally{T(!1)}},V=a=>{n({title:a.title,description:a.description,imageUrl:a.imageUrl,githubUrl:a.githubUrl,demoUrl:a.demoUrl||"",category:a.category||"academico"}),m(a.technologies),u(a.teamMembers),E(a.id),N(!0)},W=async a=>{if(confirm("¿Estás seguro de eliminar este proyecto?"))try{await le(_(p,"projects",a)),v()}catch(t){console.error("Error deleting project:",t),alert("Error al eliminar el proyecto")}},G=()=>{n({title:"",description:"",imageUrl:"",githubUrl:"",demoUrl:"",category:"academico"}),m(["React","Firebase"]),u(["Alexis"]),y(""),f(""),S(null),q(""),E(null),N(!1),k({}),R({})};return K?e.jsx("div",{className:"min-h-screen bg-base-200",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(D.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Administrar Proyectos"}),e.jsx("p",{className:"text-base-content/70",children:"Gestiona los proyectos del equipo"})]}),e.jsx("button",{onClick:()=>N(!j),className:"btn btn-primary gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-5 w-5"}),"Cancelar"]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-5 w-5"}),"Nuevo Proyecto"]})})]}),j&&e.jsx(D.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"card bg-base-100 shadow-xl mb-8",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:h?"Editar Proyecto":"Nuevo Proyecto"}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Título *"})}),e.jsx("input",{type:"text",value:l.title,onChange:a=>n({...l,title:a.target.value}),className:"input input-bordered",required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"URL de GitHub *"})}),e.jsxs("div",{className:"join w-full",children:[e.jsx("span",{className:"join-item btn btn-disabled",children:e.jsx(de,{className:"h-5 w-5"})}),e.jsx("input",{type:"url",value:l.githubUrl,onChange:a=>n({...l,githubUrl:a.target.value}),className:"input input-bordered join-item w-full",placeholder:"https://github.com/...",required:!0})]})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Descripción *"})}),e.jsx("textarea",{value:l.description,onChange:a=>n({...l,description:a.target.value}),className:"textarea textarea-bordered h-24",required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Categoría del Proyecto *"})}),e.jsxs("select",{value:l.category,onChange:a=>n({...l,category:a.target.value}),className:"select select-bordered",required:!0,children:[e.jsx("option",{value:"academico",children:"Académico"}),e.jsx("option",{value:"laboral",children:"Laboral"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Imagen del Proyecto *"})}),e.jsxs("div",{className:"space-y-2",children:[(P||l.imageUrl)&&e.jsx("div",{className:"relative w-full h-48 rounded-lg overflow-hidden border-2 border-base-300",children:e.jsx("img",{src:P||l.imageUrl,alt:"Preview",className:"w-full h-full object-cover"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:X,className:"file-input file-input-bordered w-full"}),e.jsx("div",{className:"divider text-xs",children:"O"}),e.jsxs("div",{className:"join w-full",children:[e.jsx("span",{className:"join-item btn btn-disabled",children:e.jsx(z,{className:"h-5 w-5"})}),e.jsx("input",{type:"url",value:l.imageUrl,onChange:a=>n({...l,imageUrl:a.target.value}),className:"input input-bordered join-item w-full",placeholder:"O pega una URL de imagen"})]})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"URL Demo (opcional)"})}),e.jsx("input",{type:"url",value:l.demoUrl,onChange:a=>n({...l,demoUrl:a.target.value}),className:"input input-bordered",placeholder:"https://..."})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Tecnologías *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:g,onChange:a=>y(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),L())},className:"input input-bordered join-item flex-1",placeholder:"Agregar tecnología (ej: React, Node.js)"}),e.jsxs("button",{type:"button",onClick:L,className:"btn btn-primary join-item",children:[e.jsx(w,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map((a,t)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:a,onChange:s=>{const r=[...c];r[t]=s.target.value,m(r)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>B(t),className:"btn btn-error join-item",children:[e.jsx(U,{})," Eliminar"]})]},t)),c.length===0&&e.jsx("div",{className:"alert alert-warning",children:"Debe agregar al menos 1 tecnología"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Miembros del Equipo *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:x,onChange:a=>f(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),I())},className:"input input-bordered join-item flex-1",placeholder:"Agregar miembro del equipo"}),e.jsxs("button",{type:"button",onClick:I,className:"btn btn-primary join-item",children:[e.jsx(w,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[d.map((a,t)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:a,onChange:s=>{const r=[...d];r[t]=s.target.value,u(r)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>H(t),className:"btn btn-error join-item",children:[e.jsx(U,{})," Eliminar"]})]},t)),d.length===0&&e.jsx("div",{className:"alert alert-warning",children:"Debe agregar al menos 1 miembro del equipo"})]})]}),e.jsxs("div",{className:"card-actions justify-end",children:[e.jsx("button",{type:"button",onClick:G,className:"btn btn-ghost",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary gap-2",disabled:F,children:F?e.jsx("span",{className:"loading loading-spinner"}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-5 w-5"}),h?"Actualizar":"Guardar"]})})]})]})]})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:C.map((a,t)=>e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},className:"card bg-base-100 shadow-xl",children:[e.jsx("figure",{className:"h-48 bg-base-200",children:a.imageUrl?e.jsx("img",{src:a.imageUrl,alt:a.title,className:"h-full w-full object-cover"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx(z,{className:"h-16 w-16 text-base-content/30"})})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:a.title}),e.jsx("p",{className:"text-sm text-base-content/70 line-clamp-2",children:a.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:a.technologies.slice(0,3).map((s,r)=>e.jsx("span",{className:"badge badge-sm badge-primary badge-outline",children:s},r))}),e.jsxs("div",{className:"card-actions justify-end mt-4",children:[e.jsxs("button",{onClick:()=>V(a),className:"btn btn-sm btn-ghost gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>W(a.id),className:"btn btn-sm btn-error gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Eliminar"]})]})]})]},a.id))}),C.length===0&&e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-base-content/70",children:"No hay proyectos todavía"})})]})}):e.jsx(ee,{to:"/login",replace:!0})};export{Ne as default};
