import{r as c,j as e,m as K,n as O,o as V,s as Q}from"./index-DruzbSZu.js";import{a as X,u as Y,d as Z}from"./firestore-Cdc_pf3y.js";import{F as o}from"./FormUtils-X4tq9MxD.js";import{v as ee,x as _,z as ae}from"./index-DfODkuc1.js";const P={displayName:"",email:"",specialty:"",bio:"",role:"programmer",photoURL:"",github:"",instagram:"",whatsapp:""},ie=()=>{const[r,j]=c.useState(P),[S,H]=c.useState([]),[L,F]=c.useState(!1),[U,k]=c.useState(""),[$,N]=c.useState(""),[B,R]=c.useState(null),[D,f]=c.useState(""),[t,h]=c.useState({}),[n,u]=c.useState({}),[g,C]=c.useState(null),[m,x]=c.useState(["JavaScript","React"]),[y,w]=c.useState(""),v={displayName:[a=>o.required(a),a=>o.minLength(a,3)],email:[a=>o.required(a),a=>o.email(a)],specialty:[a=>o.required(a),a=>o.minLength(a,3)],bio:[a=>o.minLength(a,10)],github:[a=>a&&o.url(a)],instagram:[a=>a&&o.url(a)],whatsapp:[a=>a&&o.url(a)]},E=async()=>{const a=await X();H(a)};c.useEffect(()=>{E()},[]);const A=()=>{!y.trim()||y.length<2||(x([...m,y.trim()]),w(""))},T=a=>{x(m.filter((s,l)=>l!==a))},d=a=>{const{name:s,value:l}=a.target;if(j(i=>({...i,[s]:l})),n[s]){const i=v[s];if(i){const b=o.validate(l,i);h(W=>({...W,[s]:b||""}))}}},p=a=>{u(l=>({...l,[a]:!0}));const s=v[a];if(s){const l=o.validate(r[a],s);h(i=>({...i,[a]:l||""}))}},z=a=>{const s=a.target.files?.[0];if(s){R(s);const l=new FileReader;l.onloadend=()=>{f(l.result)},l.readAsDataURL(s)}},G=async(a,s)=>{const l=K(Q,`programmers/${a}/profile.jpg`);return await O(l,s),await V(l)},I=async a=>{a.preventDefault();const s=Object.keys(v).reduce((i,b)=>(i[b]=!0,i),{});u(s);const l=o.validateForm(r,v);if(h(l),m.length<2&&(l.skills="Debe tener al menos 2 habilidades"),o.hasErrors(l)){N("Por favor corrige los errores en el formulario.");return}F(!0),N(""),k("");try{const i=g||`prog_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;let b=r.photoURL;B&&(b=await G(i,B)),await Y(i,{displayName:r.displayName,email:r.email,specialty:r.specialty,bio:r.bio,role:"programmer",photoURL:b,skills:m,socials:{github:r.github||void 0,instagram:r.instagram||void 0,whatsapp:r.whatsapp||void 0}}),k(g?"âœ“ Programador actualizado correctamente.":"âœ“ Programador guardado correctamente."),j(P),x(["JavaScript","React"]),w(""),R(null),f(""),h({}),u({}),C(null),await E()}catch{N("No se pudo guardar. Verifica permisos y conexiÃ³n.")}finally{F(!1)}},J=a=>{C(a.id),j({displayName:a.displayName||"",email:a.email||"",specialty:a.specialty||"",bio:a.bio||"",role:"programmer",photoURL:a.photoURL||"",github:a.socials?.github||"",instagram:a.socials?.instagram||"",whatsapp:a.socials?.whatsapp||""}),x(a.skills||["JavaScript","React"]),f(a.photoURL||""),h({}),u({}),window.scrollTo({top:0,behavior:"smooth"})},q=async(a,s)=>{if(confirm(`Â¿EstÃ¡s seguro de eliminar a ${s}?`))try{await Z(a),k(`âœ“ ${s} eliminado correctamente.`),await E()}catch{N("No se pudo eliminar el programador.")}},M=()=>{C(null),j(P),x(["JavaScript","React"]),w(""),R(null),f(""),h({}),u({})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Programadores"}),e.jsx("p",{className:"text-base-content/70",children:"Crea o edita perfiles y asigna el rol de programador."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("form",{onSubmit:I,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("h2",{className:"card-title",children:g?"Editar programador":"Nuevo programador"}),U&&e.jsx("div",{className:"alert alert-success text-sm",children:U}),$&&e.jsx("div",{className:"alert alert-error text-sm",children:$}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Foto de perfil"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2",children:D||r.photoURL?e.jsx("img",{src:D||r.photoURL,alt:"Preview"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-3xl",children:"ðŸ‘¤"})})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:z,className:"file-input file-input-bordered file-input-sm w-full max-w-xs"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nombre *"})}),e.jsx("input",{name:"displayName",value:r.displayName,onChange:d,onBlur:()=>p("displayName"),className:`input input-bordered ${n.displayName&&t.displayName?"input-error":""}`}),n.displayName&&t.displayName&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.displayName})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Correo *"})}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:d,onBlur:()=>p("email"),className:`input input-bordered ${n.email&&t.email?"input-error":""}`}),n.email&&t.email&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.email})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Especialidad *"})}),e.jsx("input",{name:"specialty",value:r.specialty,onChange:d,onBlur:()=>p("specialty"),className:`input input-bordered ${n.specialty&&t.specialty?"input-error":""}`}),n.specialty&&t.specialty&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.specialty})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Bio"})}),e.jsx("textarea",{name:"bio",value:r.bio,onChange:d,onBlur:()=>p("bio"),className:`textarea textarea-bordered ${n.bio&&t.bio?"textarea-error":""}`,rows:3}),n.bio&&t.bio&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.bio})})]}),e.jsx("div",{className:"divider",children:"Habilidades / Skills"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Habilidades tÃ©cnicas *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:y,onChange:a=>w(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),A())},className:"input input-bordered join-item flex-1",placeholder:"Agregar habilidad (ej: TypeScript, Node.js)"}),e.jsxs("button",{type:"button",onClick:A,className:"btn btn-primary join-item",children:[e.jsx(ee,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[m.map((a,s)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:a,onChange:l=>{const i=[...m];i[s]=l.target.value,x(i)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>T(s),className:"btn btn-error join-item",children:[e.jsx(_,{})," Eliminar"]})]},s)),m.length<2&&e.jsx("div",{className:"alert alert-warning text-sm",children:"Debe agregar al menos 2 habilidades"})]})]}),e.jsx("div",{className:"divider",children:"Redes Sociales"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"GitHub"})}),e.jsx("input",{name:"github",value:r.github,onChange:d,onBlur:()=>p("github"),className:`input input-bordered ${n.github&&t.github?"input-error":""}`,placeholder:"https://github.com/usuario"}),n.github&&t.github&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.github})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Instagram"})}),e.jsx("input",{name:"instagram",value:r.instagram,onChange:d,onBlur:()=>p("instagram"),className:`input input-bordered ${n.instagram&&t.instagram?"input-error":""}`,placeholder:"https://instagram.com/usuario"}),n.instagram&&t.instagram&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.instagram})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"WhatsApp"})}),e.jsx("input",{name:"whatsapp",value:r.whatsapp,onChange:d,onBlur:()=>p("whatsapp"),className:`input input-bordered ${n.whatsapp&&t.whatsapp?"input-error":""}`,placeholder:"https://wa.me/593988888888"}),n.whatsapp&&t.whatsapp&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:t.whatsapp})})]}),e.jsxs("div",{className:"card-actions justify-end gap-2",children:[g&&e.jsx("button",{className:"btn btn-ghost",type:"button",onClick:M,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:L,children:L?"Guardando...":g?"Actualizar":"Guardar programador"})]})]})}),e.jsx("div",{className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:"Listado"}),e.jsx("span",{className:"badge badge-secondary",children:S.length})]}),e.jsxs("div",{className:"space-y-2",children:[S.map(a=>e.jsx("div",{className:"flex flex-col rounded-lg border border-base-200 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-lg",children:"ðŸ‘¤"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold",children:a.displayName}),e.jsx("span",{className:"badge badge-outline capitalize",children:a.specialty||"Especialidad"})]}),e.jsx("p",{className:"text-xs text-base-content/60",children:a.email}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.bio}),a.skills&&a.skills.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-semibold text-base-content/70 mb-1",children:"Habilidades:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.skills.map((s,l)=>e.jsx("span",{className:"badge badge-primary badge-sm",children:s},l))})]}),a.socials&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.socials.github&&e.jsx("a",{href:a.socials.github,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"GitHub"}),a.socials.instagram&&e.jsx("a",{href:a.socials.instagram,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"Instagram"}),a.socials.whatsapp&&e.jsx("a",{href:a.socials.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"WhatsApp"})]}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("button",{onClick:()=>J(a),className:"btn btn-sm btn-primary gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>q(a.id,a.displayName),className:"btn btn-sm btn-error gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Eliminar"]})]})]})]})},a.id)),!S.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay programadores. Crea uno con el formulario."})]})]})})]})]})};export{ie as default};
