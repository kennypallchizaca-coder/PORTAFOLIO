import{r as c,j as e}from"./index-C7oHUGbv.js";import{a as V,u as Q,d as X}from"./firestore-BZsbbwbg.js";import{F as o}from"./FormUtils-X4tq9MxD.js";import{v as Y,x as T,z as Z}from"./index-QdZ3WDKL.js";const F={displayName:"",email:"",specialty:"",bio:"",role:"programmer",photoURL:"",github:"",instagram:"",whatsapp:""},re=()=>{const[l,N]=c.useState(F),[R,z]=c.useState([]),[U,$]=c.useState(!1),[D,k]=c.useState(""),[A,f]=c.useState(""),[B,C]=c.useState(null),[_,y]=c.useState(""),[r,h]=c.useState({}),[n,u]=c.useState({}),[g,E]=c.useState(null),[m,x]=c.useState(["JavaScript","React"]),[w,v]=c.useState(""),S={displayName:[a=>o.required(a),a=>o.minLength(a,3)],email:[a=>o.required(a),a=>o.email(a)],specialty:[a=>o.required(a),a=>o.minLength(a,3)],bio:[a=>o.minLength(a,10)],github:[a=>a&&o.url(a)],instagram:[a=>a&&o.url(a)],whatsapp:[a=>a&&o.url(a)]},P=async()=>{const a=await V();z(a)};c.useEffect(()=>{P()},[]);const H=()=>{!w.trim()||w.length<2||(x([...m,w.trim()]),v(""))},G=a=>{x(m.filter((s,t)=>t!==a))},d=a=>{const{name:s,value:t}=a.target;if(N(i=>({...i,[s]:t})),n[s]){const i=S[s];if(i){const j=o.validate(t,i);h(b=>({...b,[s]:j||""}))}}},p=a=>{u(t=>({...t,[a]:!0}));const s=S[a];if(s){const t=o.validate(l[a],s);h(i=>({...i,[a]:t||""}))}},J=a=>{const s=a.target.files?.[0];if(s){C(s);const t=new FileReader;t.onloadend=()=>{y(t.result)},t.readAsDataURL(s)}},q=async a=>{a.preventDefault();const s=Object.keys(S).reduce((i,j)=>(i[j]=!0,i),{});u(s);const t=o.validateForm(l,S);if(h(t),m.length<2&&(t.skills="Debe tener al menos 2 habilidades"),o.hasErrors(t)){f("Por favor corrige los errores en el formulario.");return}$(!0),f(""),k("");try{const i=g||`prog_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;let j=l.photoURL;if(B){const L=new FileReader;j=await new Promise(O=>{L.onloadend=()=>{const I=L.result;localStorage.setItem(`photo_${i}`,I),O(I)},L.readAsDataURL(B)})}const b={};l.github&&(b.github=l.github),l.instagram&&(b.instagram=l.instagram),l.whatsapp&&(b.whatsapp=l.whatsapp),await Q(i,{displayName:l.displayName,email:l.email,specialty:l.specialty,bio:l.bio,role:"programmer",photoURL:"",skills:m,socials:b}),k(g?"âœ“ Programador actualizado correctamente.":"âœ“ Programador guardado correctamente."),N(F),x(["JavaScript","React"]),v(""),C(null),y(""),h({}),u({}),E(null),await P()}catch(i){console.error("Error al guardar programador:",i),f(`Error al guardar: ${i.message||"Verifica permisos de Firebase"}`)}finally{$(!1)}},M=a=>{E(a.id),N({displayName:a.displayName||"",email:a.email||"",specialty:a.specialty||"",bio:a.bio||"",role:"programmer",photoURL:a.photoURL||"",github:a.socials?.github||"",instagram:a.socials?.instagram||"",whatsapp:a.socials?.whatsapp||""}),x(a.skills||["JavaScript","React"]),y(a.photoURL||""),h({}),u({}),window.scrollTo({top:0,behavior:"smooth"})},W=async(a,s)=>{if(confirm(`Â¿EstÃ¡s seguro de eliminar a ${s}?`))try{await X(a),k(`âœ“ ${s} eliminado correctamente.`),await P()}catch{f("No se pudo eliminar el programador.")}},K=()=>{E(null),N(F),x(["JavaScript","React"]),v(""),C(null),y(""),h({}),u({})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Programadores"}),e.jsx("p",{className:"text-base-content/70",children:"Crea o edita perfiles y asigna el rol de programador."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("form",{onSubmit:q,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("h2",{className:"card-title",children:g?"Editar programador":"Nuevo programador"}),D&&e.jsx("div",{className:"alert alert-success text-sm",children:D}),A&&e.jsx("div",{className:"alert alert-error text-sm",children:A}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Foto de perfil"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2",children:_||l.photoURL?e.jsx("img",{src:_||l.photoURL,alt:"Preview"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-3xl",children:"ðŸ‘¤"})})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:J,className:"file-input file-input-bordered file-input-sm w-full max-w-xs"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nombre *"})}),e.jsx("input",{name:"displayName",value:l.displayName,onChange:d,onBlur:()=>p("displayName"),className:`input input-bordered ${n.displayName&&r.displayName?"input-error":""}`}),n.displayName&&r.displayName&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.displayName})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Correo *"})}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:d,onBlur:()=>p("email"),className:`input input-bordered ${n.email&&r.email?"input-error":""}`}),n.email&&r.email&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.email})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Especialidad *"})}),e.jsx("input",{name:"specialty",value:l.specialty,onChange:d,onBlur:()=>p("specialty"),className:`input input-bordered ${n.specialty&&r.specialty?"input-error":""}`}),n.specialty&&r.specialty&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.specialty})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Bio"})}),e.jsx("textarea",{name:"bio",value:l.bio,onChange:d,onBlur:()=>p("bio"),className:`textarea textarea-bordered ${n.bio&&r.bio?"textarea-error":""}`,rows:3}),n.bio&&r.bio&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.bio})})]}),e.jsx("div",{className:"divider",children:"Habilidades / Skills"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Habilidades tÃ©cnicas *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:w,onChange:a=>v(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),H())},className:"input input-bordered join-item flex-1",placeholder:"Agregar habilidad (ej: TypeScript, Node.js)"}),e.jsxs("button",{type:"button",onClick:H,className:"btn btn-primary join-item",children:[e.jsx(Y,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[m.map((a,s)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:a,onChange:t=>{const i=[...m];i[s]=t.target.value,x(i)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>G(s),className:"btn btn-error join-item",children:[e.jsx(T,{})," Eliminar"]})]},s)),m.length<2&&e.jsx("div",{className:"alert alert-warning text-sm",children:"Debe agregar al menos 2 habilidades"})]})]}),e.jsx("div",{className:"divider",children:"Redes Sociales"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"GitHub"})}),e.jsx("input",{name:"github",value:l.github,onChange:d,onBlur:()=>p("github"),className:`input input-bordered ${n.github&&r.github?"input-error":""}`,placeholder:"https://github.com/usuario"}),n.github&&r.github&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.github})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Instagram"})}),e.jsx("input",{name:"instagram",value:l.instagram,onChange:d,onBlur:()=>p("instagram"),className:`input input-bordered ${n.instagram&&r.instagram?"input-error":""}`,placeholder:"https://instagram.com/usuario"}),n.instagram&&r.instagram&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.instagram})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"WhatsApp"})}),e.jsx("input",{name:"whatsapp",value:l.whatsapp,onChange:d,onBlur:()=>p("whatsapp"),className:`input input-bordered ${n.whatsapp&&r.whatsapp?"input-error":""}`,placeholder:"https://wa.me/593988888888"}),n.whatsapp&&r.whatsapp&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.whatsapp})})]}),e.jsxs("div",{className:"card-actions justify-end gap-2",children:[g&&e.jsx("button",{className:"btn btn-ghost",type:"button",onClick:K,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:U,children:U?"Guardando...":g?"Actualizar":"Guardar programador"})]})]})}),e.jsx("div",{className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:"Listado"}),e.jsx("span",{className:"badge badge-secondary",children:R.length})]}),e.jsxs("div",{className:"space-y-2",children:[R.map(a=>e.jsx("div",{className:"flex flex-col rounded-lg border border-base-200 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-lg",children:"ðŸ‘¤"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold",children:a.displayName}),e.jsx("span",{className:"badge badge-outline capitalize",children:a.specialty||"Especialidad"})]}),e.jsx("p",{className:"text-xs text-base-content/60",children:a.email}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.bio}),a.skills&&a.skills.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-semibold text-base-content/70 mb-1",children:"Habilidades:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.skills.map((s,t)=>e.jsx("span",{className:"badge badge-primary badge-sm",children:s},t))})]}),a.socials&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.socials.github&&e.jsx("a",{href:a.socials.github,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"GitHub"}),a.socials.instagram&&e.jsx("a",{href:a.socials.instagram,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"Instagram"}),a.socials.whatsapp&&e.jsx("a",{href:a.socials.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"WhatsApp"})]}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("button",{onClick:()=>M(a),className:"btn btn-sm btn-primary gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>W(a.id,a.displayName),className:"btn btn-sm btn-error gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Eliminar"]})]})]})]})},a.id)),!R.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay programadores. Crea uno con el formulario."})]})]})})]})]})};export{re as default};
