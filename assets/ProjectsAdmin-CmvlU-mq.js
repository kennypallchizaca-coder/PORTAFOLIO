import{u as Y,r as i,g as Z,d as O,e as p,j as e,N as ee,T as se,h as ae,i as _,k as te,l as le,m as re,s as ie,n as ne,o as oe}from"./index-D9nvKaiz.js";import{u as ce,v as w,q as de,w as z,x as U,y as me,z as ue}from"./index-SMITuqPN.js";import{F as n}from"./FormUtils-X4tq9MxD.js";import{m as D}from"./proxy-D0gjRs53.js";const Ne=()=>{const{user:K}=Y(),[E,$]=i.useState([]),[j,N]=i.useState(!1),[h,F]=i.useState(null),[C,T]=i.useState(!1),[S,A]=i.useState(null),[P,q]=i.useState(""),[o,m]=i.useState(["React","Firebase"]),[c,u]=i.useState(["Alexis"]),[g,f]=i.useState(""),[x,y]=i.useState(""),[l,d]=i.useState({title:"",description:"",imageUrl:"",githubUrl:"",demoUrl:""}),[he,k]=i.useState({}),[ge,R]=i.useState({}),M={title:[s=>n.required(s),s=>n.minLength(s,3)],description:[s=>n.required(s),s=>n.minLength(s,10)],githubUrl:[s=>s&&n.url(s)],demoUrl:[s=>s&&n.url(s)]};i.useEffect(()=>{v()},[]);const v=async()=>{try{const t=(await Z(O(p,"projects"))).docs.map(a=>({id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate()||new Date}));$(t.sort((a,r)=>r.createdAt.getTime()-a.createdAt.getTime()))}catch(s){console.error("Error fetching projects:",s)}},I=()=>{!g.trim()||g.length<2||(m([...o,g.trim()]),f(""))},B=s=>{m(o.filter((t,a)=>a!==s))},L=()=>{!x.trim()||x.length<3||(u([...c,x.trim()]),y(""))},H=s=>{u(c.filter((t,a)=>a!==s))},X=s=>{const t=s.target.files?.[0];if(t){A(t);const a=new FileReader;a.onloadend=()=>{q(a.result)},a.readAsDataURL(t)}},J=async s=>{const t=Date.now(),a=re(ie,`projects/${t}_${s.name}`);return await ne(a,s),await oe(a)},Q=async s=>{s.preventDefault();const t=Object.keys(M).reduce((r,b)=>(r[b]=!0,r),{});R(t);const a=n.validateForm(l,M);if(k(a),o.length<1&&(a.technologies="Debe tener al menos 1 tecnología"),c.length<1&&(a.teamMembers="Debe tener al menos 1 miembro del equipo"),n.hasErrors(a)){alert("Por favor corrige los errores en el formulario.");return}T(!0);try{let r=l.imageUrl;S&&(r=await J(S));const b={title:l.title,description:l.description,imageUrl:r,githubUrl:l.githubUrl,demoUrl:l.demoUrl||"",technologies:o,teamMembers:c,createdAt:se.now()};h?await ae(_(p,"projects",h),b):await te(O(p,"projects"),b),alert("✓ Proyecto guardado correctamente."),G(),v()}catch(r){console.error("Error saving project:",r),alert("Error al guardar el proyecto")}finally{T(!1)}},V=s=>{d({title:s.title,description:s.description,imageUrl:s.imageUrl,githubUrl:s.githubUrl,demoUrl:s.demoUrl||""}),m(s.technologies),u(s.teamMembers),F(s.id),N(!0)},W=async s=>{if(confirm("¿Estás seguro de eliminar este proyecto?"))try{await le(_(p,"projects",s)),v()}catch(t){console.error("Error deleting project:",t),alert("Error al eliminar el proyecto")}},G=()=>{d({title:"",description:"",imageUrl:"",githubUrl:"",demoUrl:""}),m(["React","Firebase"]),u(["Alexis"]),f(""),y(""),A(null),q(""),F(null),N(!1),k({}),R({})};return K?e.jsx("div",{className:"min-h-screen bg-base-200",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(D.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Administrar Proyectos"}),e.jsx("p",{className:"text-base-content/70",children:"Gestiona los proyectos del equipo"})]}),e.jsx("button",{onClick:()=>N(!j),className:"btn btn-primary gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-5 w-5"}),"Cancelar"]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-5 w-5"}),"Nuevo Proyecto"]})})]}),j&&e.jsx(D.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"card bg-base-100 shadow-xl mb-8",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:h?"Editar Proyecto":"Nuevo Proyecto"}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Título *"})}),e.jsx("input",{type:"text",value:l.title,onChange:s=>d({...l,title:s.target.value}),className:"input input-bordered",required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"URL de GitHub *"})}),e.jsxs("div",{className:"join w-full",children:[e.jsx("span",{className:"join-item btn btn-disabled",children:e.jsx(de,{className:"h-5 w-5"})}),e.jsx("input",{type:"url",value:l.githubUrl,onChange:s=>d({...l,githubUrl:s.target.value}),className:"input input-bordered join-item w-full",placeholder:"https://github.com/...",required:!0})]})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Descripción *"})}),e.jsx("textarea",{value:l.description,onChange:s=>d({...l,description:s.target.value}),className:"textarea textarea-bordered h-24",required:!0})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Imagen del Proyecto *"})}),e.jsxs("div",{className:"space-y-2",children:[(P||l.imageUrl)&&e.jsx("div",{className:"relative w-full h-48 rounded-lg overflow-hidden border-2 border-base-300",children:e.jsx("img",{src:P||l.imageUrl,alt:"Preview",className:"w-full h-full object-cover"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:X,className:"file-input file-input-bordered w-full"}),e.jsx("div",{className:"divider text-xs",children:"O"}),e.jsxs("div",{className:"join w-full",children:[e.jsx("span",{className:"join-item btn btn-disabled",children:e.jsx(z,{className:"h-5 w-5"})}),e.jsx("input",{type:"url",value:l.imageUrl,onChange:s=>d({...l,imageUrl:s.target.value}),className:"input input-bordered join-item w-full",placeholder:"O pega una URL de imagen"})]})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"URL Demo (opcional)"})}),e.jsx("input",{type:"url",value:l.demoUrl,onChange:s=>d({...l,demoUrl:s.target.value}),className:"input input-bordered",placeholder:"https://..."})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Tecnologías *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:g,onChange:s=>f(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),I())},className:"input input-bordered join-item flex-1",placeholder:"Agregar tecnología (ej: React, Node.js)"}),e.jsxs("button",{type:"button",onClick:I,className:"btn btn-primary join-item",children:[e.jsx(w,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[o.map((s,t)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:s,onChange:a=>{const r=[...o];r[t]=a.target.value,m(r)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>B(t),className:"btn btn-error join-item",children:[e.jsx(U,{})," Eliminar"]})]},t)),o.length===0&&e.jsx("div",{className:"alert alert-warning",children:"Debe agregar al menos 1 tecnología"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Miembros del Equipo *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:x,onChange:s=>y(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),L())},className:"input input-bordered join-item flex-1",placeholder:"Agregar miembro del equipo"}),e.jsxs("button",{type:"button",onClick:L,className:"btn btn-primary join-item",children:[e.jsx(w,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map((s,t)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:s,onChange:a=>{const r=[...c];r[t]=a.target.value,u(r)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>H(t),className:"btn btn-error join-item",children:[e.jsx(U,{})," Eliminar"]})]},t)),c.length===0&&e.jsx("div",{className:"alert alert-warning",children:"Debe agregar al menos 1 miembro del equipo"})]})]}),e.jsxs("div",{className:"card-actions justify-end",children:[e.jsx("button",{type:"button",onClick:G,className:"btn btn-ghost",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary gap-2",disabled:C,children:C?e.jsx("span",{className:"loading loading-spinner"}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-5 w-5"}),h?"Actualizar":"Guardar"]})})]})]})]})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:E.map((s,t)=>e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},className:"card bg-base-100 shadow-xl",children:[e.jsx("figure",{className:"h-48 bg-base-200",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.title,className:"h-full w-full object-cover"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx(z,{className:"h-16 w-16 text-base-content/30"})})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:s.title}),e.jsx("p",{className:"text-sm text-base-content/70 line-clamp-2",children:s.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.technologies.slice(0,3).map((a,r)=>e.jsx("span",{className:"badge badge-sm badge-primary badge-outline",children:a},r))}),e.jsxs("div",{className:"card-actions justify-end mt-4",children:[e.jsxs("button",{onClick:()=>V(s),className:"btn btn-sm btn-ghost gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>W(s.id),className:"btn btn-sm btn-error gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Eliminar"]})]})]})]},s.id))}),E.length===0&&e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-base-content/70",children:"No hay proyectos todavía"})})]})}):e.jsx(ee,{to:"/login",replace:!0})};export{Ne as default};
