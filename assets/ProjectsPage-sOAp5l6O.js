import{u as R,r as t,j as e}from"./index-BVC0icWY.js";import{l as F,e as D,f as A}from"./firestore-DeDfMWJn.js";import{x as B}from"./index-GXs0CitT.js";const j={title:"",description:"",category:"academico",role:"frontend",techStack:"",repoUrl:"",demoUrl:"",imageUrl:"",programmerName:""},z=()=>{const{user:i}=R(),[g,b]=t.useState([]),[s,d]=t.useState(j),[n,m]=t.useState(null),[N,f]=t.useState(!1),[v,h]=t.useState(""),[y,x]=t.useState(""),[U,w]=t.useState(null),[S,u]=t.useState(""),p=t.useCallback(async()=>{if(i?.uid)try{const a=await F(i.uid);b(a)}catch(a){console.error("Error al cargar proyectos:",a),x("No se pudieron cargar los proyectos."),b([])}},[i?.uid]);t.useEffect(()=>{p()},[p]);const c=a=>{const{name:l,value:r}=a.target;d(o=>({...o,[l]:r}))},C=a=>{const l=a.target.files?.[0];if(l){w(l);const r=new FileReader;r.onloadend=()=>{u(r.result)},r.readAsDataURL(l)}},k=async a=>{a.preventDefault(),f(!0),h(""),x("");try{const l={title:s.title,description:s.description,category:s.category,role:s.role,techStack:s.techStack.split(",").map(o=>o.trim()).filter(Boolean),repoUrl:s.repoUrl,demoUrl:s.demoUrl,imageUrl:"",programmerName:s.programmerName};let r=n;if(n)await D(n,l),h("Proyecto actualizado.");else{if(!i?.uid)throw new Error("Usuario no autenticado");r=(await A(i.uid,l)).id,h("Proyecto creado.")}if(U&&r){console.log("ðŸ“¸ Guardando imagen en localStorage con ID:",r);const o=new FileReader;await new Promise(E=>{o.onloadend=()=>{const I=o.result;localStorage.setItem(`project_img_${r}`,I),console.log("âœ… Imagen guardada en localStorage"),E()},o.readAsDataURL(U)})}d(j),m(null),w(null),u(""),await p()}catch(l){console.error("Error al guardar proyecto:",l),x("No se pudo guardar el proyecto.")}finally{f(!1)}},P=a=>{m(a.id),d({title:a.title,description:a.description,category:a.category,role:a.role,techStack:a.techStack?.join(", ")||"",repoUrl:a.repoUrl||"",demoUrl:a.demoUrl||"",imageUrl:a.imageUrl||"",programmerName:a.programmerName||""}),u(a.imageUrl||"")};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Proyectos"}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsx("form",{onSubmit:k,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:n?"Editar proyecto":"Nuevo proyecto"}),n&&e.jsx("button",{type:"button",className:"btn btn-ghost btn-xs",onClick:()=>{m(null),d(j)},children:"Cancelar"})]}),v&&e.jsx("div",{className:"alert alert-success text-sm",children:v}),y&&e.jsx("div",{className:"alert alert-error text-sm",children:y}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"TÃ­tulo *"})}),e.jsx("input",{name:"title",value:s.title,onChange:c,className:"input input-bordered",required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"DescripciÃ³n"})}),e.jsx("textarea",{name:"description",value:s.description,onChange:c,className:"textarea textarea-bordered",rows:3})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nombre del programador"})}),e.jsx("input",{name:"programmerName",value:s.programmerName,onChange:c,className:"input input-bordered",placeholder:"Tu nombre"})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"CategorÃ­a"})}),e.jsxs("select",{name:"category",value:s.category,onChange:c,className:"select select-bordered",children:[e.jsx("option",{value:"academico",children:"AcadÃ©mico"}),e.jsx("option",{value:"laboral",children:"Laboral"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Rol"})}),e.jsxs("select",{name:"role",value:s.role,onChange:c,className:"select select-bordered",children:[e.jsx("option",{value:"frontend",children:"Frontend"}),e.jsx("option",{value:"backend",children:"Backend"}),e.jsx("option",{value:"fullstack",children:"Fullstack"}),e.jsx("option",{value:"db",children:"Base de datos"})]})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"TecnologÃ­as (coma)"})}),e.jsx("input",{name:"techStack",value:s.techStack,onChange:c,className:"input input-bordered",placeholder:"React, Firebase, Tailwind"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Imagen del proyecto"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[S&&e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-32 rounded",children:e.jsx("img",{src:S,alt:"Preview"})})}),e.jsxs("label",{className:"btn btn-outline btn-sm gap-2 w-fit",children:[e.jsx(B,{}),"Seleccionar imagen",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:C})]})]})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Repo"})}),e.jsx("input",{name:"repoUrl",value:s.repoUrl,onChange:c,className:"input input-bordered",placeholder:"https://github.com/..."})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Demo"})}),e.jsx("input",{name:"demoUrl",value:s.demoUrl,onChange:c,className:"input input-bordered",placeholder:"https://app..."})]})]}),e.jsx("div",{className:"card-actions justify-end",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:N,children:N?"Guardando...":n?"Actualizar proyecto":"Crear proyecto"})})]})}),e.jsxs("div",{className:"space-y-2",children:[g.map(a=>e.jsx("div",{className:"card bg-base-100 shadow-sm",children:e.jsxs("div",{className:"card-body space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:a.title}),e.jsxs("p",{className:"text-xs text-base-content/60",children:[a.category," Â· ",a.role]})]}),e.jsx("button",{className:"btn btn-ghost btn-xs",onClick:()=>P(a),children:"Editar"})]}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.description}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.techStack?.map(l=>e.jsx("span",{className:"badge badge-ghost",children:l},l))}),e.jsxs("div",{className:"card-actions justify-end",children:[a.repoUrl&&e.jsx("a",{className:"btn btn-outline btn-xs",href:a.repoUrl,target:"_blank",rel:"noreferrer",children:"CÃ³digo"}),a.demoUrl&&e.jsx("a",{className:"btn btn-primary btn-xs",href:a.demoUrl,target:"_blank",rel:"noreferrer",children:"Demo"})]})]})},a.id)),!g.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay proyectos."})]})]})]})};export{z as default};
