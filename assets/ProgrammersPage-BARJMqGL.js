import{r as o,j as e,m as M,n as O,o as V,s as Q}from"./index-Dp-_kc_8.js";import{a as X,u as Y,d as Z}from"./firestore-wDcLSI31.js";import{F as c}from"./FormUtils-X4tq9MxD.js";import{v as ee,x as I,z as ae}from"./index-BFeof-vj.js";const P={uid:"",displayName:"",email:"",specialty:"",bio:"",role:"programmer",photoURL:"",github:"",instagram:"",whatsapp:""},ie=()=>{const[r,g]=o.useState(P),[v,H]=o.useState([]),[L,U]=o.useState(!1),[F,S]=o.useState(""),[D,j]=o.useState(""),[$,k]=o.useState(null),[B,N]=o.useState(""),[l,u]=o.useState({}),[i,b]=o.useState({}),[p,C]=o.useState(null),[h,x]=o.useState(["JavaScript","React"]),[f,y]=o.useState(""),w={uid:[a=>c.required(a)],displayName:[a=>c.required(a),a=>c.minLength(a,3)],email:[a=>c.required(a),a=>c.email(a)],specialty:[a=>c.required(a),a=>c.minLength(a,3)],bio:[a=>c.minLength(a,10)],github:[a=>a&&c.url(a)],instagram:[a=>a&&c.url(a)],whatsapp:[a=>a&&c.url(a)]},R=async()=>{const a=await X();H(a)};o.useEffect(()=>{R()},[]);const A=()=>{!f.trim()||f.length<2||(x([...h,f.trim()]),y(""))},T=a=>{x(h.filter((s,t)=>t!==a))},d=a=>{const{name:s,value:t}=a.target;if(g(n=>({...n,[s]:t})),i[s]){const n=w[s];if(n){const E=c.validate(t,n);u(K=>({...K,[s]:E||""}))}}},m=a=>{b(t=>({...t,[a]:!0}));const s=w[a];if(s){const t=c.validate(r[a],s);u(n=>({...n,[a]:t||""}))}},q=a=>{const s=a.target.files?.[0];if(s){k(s);const t=new FileReader;t.onloadend=()=>{N(t.result)},t.readAsDataURL(s)}},z=async(a,s)=>{const t=M(Q,`programmers/${a}/profile.jpg`);return await O(t,s),await V(t)},G=async a=>{a.preventDefault();const s=Object.keys(w).reduce((n,E)=>(n[E]=!0,n),{});b(s);const t=c.validateForm(r,w);if(u(t),h.length<2&&(t.skills="Debe tener al menos 2 habilidades"),c.hasErrors(t)){j("Por favor corrige los errores en el formulario.");return}U(!0),j(""),S("");try{let n=r.photoURL;$&&(n=await z(r.uid,$)),await Y(r.uid,{displayName:r.displayName,email:r.email,specialty:r.specialty,bio:r.bio,role:"programmer",photoURL:n,skills:h,socials:{github:r.github||void 0,instagram:r.instagram||void 0,whatsapp:r.whatsapp||void 0}}),S(p?"âœ“ Programador actualizado correctamente.":"âœ“ Programador guardado correctamente."),g(P),x(["JavaScript","React"]),y(""),k(null),N(""),u({}),b({}),C(null),await R()}catch{j("No se pudo guardar. Verifica permisos y conexiÃ³n.")}finally{U(!1)}},J=a=>{C(a.id),g({uid:a.id,displayName:a.displayName||"",email:a.email||"",specialty:a.specialty||"",bio:a.bio||"",role:"programmer",photoURL:a.photoURL||"",github:a.socials?.github||"",instagram:a.socials?.instagram||"",whatsapp:a.socials?.whatsapp||""}),x(a.skills||["JavaScript","React"]),N(a.photoURL||""),u({}),b({}),window.scrollTo({top:0,behavior:"smooth"})},_=async(a,s)=>{if(confirm(`Â¿EstÃ¡s seguro de eliminar a ${s}?`))try{await Z(a),S(`âœ“ ${s} eliminado correctamente.`),await R()}catch{j("No se pudo eliminar el programador.")}},W=()=>{C(null),g(P),x(["JavaScript","React"]),y(""),k(null),N(""),u({}),b({})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Programadores"}),e.jsx("p",{className:"text-base-content/70",children:"Crea o edita perfiles y asigna el rol de programador."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("form",{onSubmit:G,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("h2",{className:"card-title",children:p?"Editar programador":"Nuevo programador"}),F&&e.jsx("div",{className:"alert alert-success text-sm",children:F}),D&&e.jsx("div",{className:"alert alert-error text-sm",children:D}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Foto de perfil"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2",children:B||r.photoURL?e.jsx("img",{src:B||r.photoURL,alt:"Preview"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-3xl",children:"ðŸ‘¤"})})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:q,className:"file-input file-input-bordered file-input-sm w-full max-w-xs"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"UID de Firebase *"})}),e.jsx("input",{name:"uid",value:r.uid,onChange:d,onBlur:()=>m("uid"),disabled:!!p,className:`input input-bordered ${i.uid&&l.uid?"input-error":""} ${p?"input-disabled":""}`,placeholder:"UID del usuario autenticado"}),i.uid&&l.uid&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:l.uid})}),e.jsx("span",{className:"label-text-alt text-base-content/60",children:p?"El UID no se puede modificar":"Se crea el documento en users con este UID y rol programmer."})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nombre *"})}),e.jsx("input",{name:"displayName",value:r.displayName,onChange:d,onBlur:()=>m("displayName"),className:`input input-bordered ${i.displayName&&l.displayName?"input-error":""}`}),i.displayName&&l.displayName&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:l.displayName})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Correo *"})}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:d,onBlur:()=>m("email"),className:`input input-bordered ${i.email&&l.email?"input-error":""}`}),i.email&&l.email&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:l.email})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Especialidad *"})}),e.jsx("input",{name:"specialty",value:r.specialty,onChange:d,onBlur:()=>m("specialty"),className:`input input-bordered ${i.specialty&&l.specialty?"input-error":""}`}),i.specialty&&l.specialty&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:l.specialty})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Bio"})}),e.jsx("textarea",{name:"bio",value:r.bio,onChange:d,onBlur:()=>m("bio"),className:`textarea textarea-bordered ${i.bio&&l.bio?"textarea-error":""}`,rows:3}),i.bio&&l.bio&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:l.bio})})]}),e.jsx("div",{className:"divider",children:"Habilidades / Skills"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Habilidades tÃ©cnicas *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:f,onChange:a=>y(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),A())},className:"input input-bordered join-item flex-1",placeholder:"Agregar habilidad (ej: TypeScript, Node.js)"}),e.jsxs("button",{type:"button",onClick:A,className:"btn btn-primary join-item",children:[e.jsx(ee,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[h.map((a,s)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:a,onChange:t=>{const n=[...h];n[s]=t.target.value,x(n)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>T(s),className:"btn btn-error join-item",children:[e.jsx(I,{})," Eliminar"]})]},s)),h.length<2&&e.jsx("div",{className:"alert alert-warning text-sm",children:"Debe agregar al menos 2 habilidades"})]})]}),e.jsx("div",{className:"divider",children:"Redes Sociales"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"GitHub"})}),e.jsx("input",{name:"github",value:r.github,onChange:d,onBlur:()=>m("github"),className:`input input-bordered ${i.github&&l.github?"input-error":""}`,placeholder:"https://github.com/usuario"}),i.github&&l.github&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:l.github})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Instagram"})}),e.jsx("input",{name:"instagram",value:r.instagram,onChange:d,onBlur:()=>m("instagram"),className:`input input-bordered ${i.instagram&&l.instagram?"input-error":""}`,placeholder:"https://instagram.com/usuario"}),i.instagram&&l.instagram&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:l.instagram})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"WhatsApp"})}),e.jsx("input",{name:"whatsapp",value:r.whatsapp,onChange:d,onBlur:()=>m("whatsapp"),className:`input input-bordered ${i.whatsapp&&l.whatsapp?"input-error":""}`,placeholder:"https://wa.me/593988888888"}),i.whatsapp&&l.whatsapp&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:l.whatsapp})})]}),e.jsxs("div",{className:"card-actions justify-end gap-2",children:[p&&e.jsx("button",{className:"btn btn-ghost",type:"button",onClick:W,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:L,children:L?"Guardando...":p?"Actualizar":"Guardar programador"})]})]})}),e.jsx("div",{className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:"Listado"}),e.jsx("span",{className:"badge badge-secondary",children:v.length})]}),e.jsxs("div",{className:"space-y-2",children:[v.map(a=>e.jsx("div",{className:"flex flex-col rounded-lg border border-base-200 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-lg",children:"ðŸ‘¤"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold",children:a.displayName}),e.jsx("span",{className:"badge badge-outline capitalize",children:a.specialty||"Especialidad"})]}),e.jsx("p",{className:"text-xs text-base-content/60",children:a.email}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.bio}),a.skills&&a.skills.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-semibold text-base-content/70 mb-1",children:"Habilidades:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.skills.map((s,t)=>e.jsx("span",{className:"badge badge-primary badge-sm",children:s},t))})]}),a.socials&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.socials.github&&e.jsx("a",{href:a.socials.github,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"GitHub"}),a.socials.instagram&&e.jsx("a",{href:a.socials.instagram,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"Instagram"}),a.socials.whatsapp&&e.jsx("a",{href:a.socials.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"WhatsApp"})]}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("button",{onClick:()=>J(a),className:"btn btn-sm btn-primary gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>_(a.id,a.displayName),className:"btn btn-sm btn-error gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Eliminar"]})]})]})]})},a.id)),!v.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay programadores. Crea uno con el formulario."})]})]})})]})]})};export{ie as default};
