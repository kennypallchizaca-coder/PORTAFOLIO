import{r as t,j as e}from"./index-DuBGklgq.js";import{a as q,b as C,s as D}from"./firestore-RHlngpKj.js";import{f as I}from"./fotoalexis-DjkPUR1l.js";const b={programmerId:"",requesterName:"",requesterEmail:"",date:"",time:"",note:""},N=[{id:"alexis-static",displayName:"Alexis",specialty:"Full Stack Developer",bio:"Desarrollador full-stack especializado en React, Node.js y Firebase.",email:"aguamanp4@est.ups.edu.ec",photoURL:I,isStatic:!0,skills:["JavaScript","React","Node.js","TypeScript","Firebase","MongoDB","Express"]},{id:"daniel-static",displayName:"Daniel",specialty:"Frontend Developer",bio:"Experto en desarrollo frontend con React y TypeScript.",email:"aguamanp4@est.ups.edu.ec",photoURL:"https://api.dicebear.com/7.x/avataaars/svg?seed=Daniel",isStatic:!0,skills:["React","TypeScript","TailwindCSS","HTML5","CSS3","Responsive Design"]}],P=()=>{const[a,n]=t.useState(b),[p,u]=t.useState(!1),[c,j]=t.useState(N),[x,h]=t.useState(""),[g,m]=t.useState(""),[v,f]=t.useState([]),[R,y]=t.useState(null);t.useEffect(()=>{q().then(s=>{j([...N,...s])})},[]);const l=s=>{const{name:r,value:o}=s.target;if(n(i=>({...i,[r]:o})),r==="programmerId"){const i=c.find(d=>d.id===o);i&&(y(i),f(i.schedule||[])),n(d=>({...d,date:"",time:""}))}},S=()=>{if(!a.programmerId||!a.requesterName||!a.requesterEmail||!a.date||!a.time)return!1;const s=new Date(a.date),r=new Date;return r.setHours(0,0,0,0),s>=r},E=async s=>{if(s.preventDefault(),!S()){m("Completa los campos obligatorios.");return}u(!0),m(""),h("");try{const r=c.find(o=>o.id===a.programmerId);await C({programmerId:a.programmerId,programmerEmail:r?.email,programmerName:r?.displayName,requesterName:a.requesterName,requesterEmail:a.requesterEmail,slot:{date:a.date,time:a.time},note:a.note}),await D({programmerEmail:r?.email,programmerName:r?.displayName,requesterName:a.requesterName,requesterEmail:a.requesterEmail,date:a.date,time:a.time,note:a.note}),h("Solicitud enviada. El programador recibira un correo y te avisaremos por email cuando responda."),n(b)}catch(r){console.error("Error al enviar solicitud:",r);const o=r instanceof Error?r.message:"Error desconocido";m(`No se pudo enviar la solicitud: ${o}`)}finally{u(!1)}};return e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Agendar Asesoría"}),e.jsx("p",{className:"text-base-content/70 mb-6",children:"Selecciona programador, fecha y hora. El programador aprobará o rechazará tu solicitud."}),e.jsx("form",{onSubmit:E,className:"card bg-base-100 shadow-lg",children:e.jsxs("div",{className:"card-body space-y-4",children:[x&&e.jsx("div",{className:"alert alert-success text-sm",children:x}),g&&e.jsx("div",{className:"alert alert-error text-sm",children:g}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Programador *"})}),e.jsxs("select",{name:"programmerId",value:a.programmerId,onChange:l,className:"select select-bordered",required:!0,children:[e.jsx("option",{value:"",children:"Selecciona"}),c.map(s=>e.jsxs("option",{value:s.id,children:[s.displayName," · ",s.specialty]},s.id))]}),e.jsx("span",{className:"label-text-alt text-base-content/60",children:"Lista cargada desde Firestore (rol programmer)."})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Tu nombre *"})}),e.jsx("input",{name:"requesterName",value:a.requesterName,onChange:l,className:"input input-bordered",placeholder:"Nombre de quien solicita"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Correo *"})}),e.jsx("input",{type:"email",name:"requesterEmail",value:a.requesterEmail,onChange:l,className:"input input-bordered",placeholder:"correo@ejemplo.com"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Fecha *"})}),e.jsx("input",{type:"date",name:"date",value:a.date,onChange:l,className:"input input-bordered"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Hora disponible *"})}),e.jsxs("select",{name:"time",value:a.time,onChange:l,className:"select select-bordered",required:!0,disabled:!a.programmerId,children:[e.jsx("option",{value:"",children:"Selecciona hora"}),v.map(s=>e.jsx("option",{value:s,children:s},s))]}),!a.programmerId&&e.jsx("span",{className:"label-text-alt text-base-content/60",children:"Selecciona un programador primero"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Motivo / nota"})}),e.jsx("textarea",{name:"note",value:a.note,onChange:l,className:"textarea textarea-bordered",rows:3})]}),e.jsx("div",{className:"card-actions justify-end",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:p,children:p?"Enviando...":"Enviar solicitud"})})]})})]})};export{P as default};
