import{r as o,j as e,m as I,n as k,o as q,s as A}from"./index-DDJPxbpu.js";import{a as G,u as _}from"./firestore-DwEaKEMM.js";import{F as n}from"./FormUtils-X4tq9MxD.js";const U={uid:"",displayName:"",email:"",specialty:"",bio:"",role:"programmer",photoURL:"",github:"",instagram:"",whatsapp:""},z=()=>{const[l,N]=o.useState(U),[x,B]=o.useState([]),[j,f]=o.useState(!1),[y,v]=o.useState(""),[w,u]=o.useState(""),[P,R]=o.useState(null),[C,L]=o.useState(""),[s,p]=o.useState({}),[r,b]=o.useState({}),h={uid:[a=>n.required(a)],displayName:[a=>n.required(a),a=>n.minLength(a,3)],email:[a=>n.required(a),a=>n.email(a)],specialty:[a=>n.required(a),a=>n.minLength(a,3)],bio:[a=>n.minLength(a,10)],github:[a=>a&&n.url(a)],instagram:[a=>a&&n.url(a)],whatsapp:[a=>a&&n.url(a)]},S=async()=>{const a=await G();B(a)};o.useEffect(()=>{S()},[]);const d=a=>{const{name:i,value:t}=a.target;if(N(c=>({...c,[i]:t})),r[i]){const c=h[i];if(c){const g=n.validate(t,c);p(D=>({...D,[i]:g||""}))}}},m=a=>{b(t=>({...t,[a]:!0}));const i=h[a];if(i){const t=n.validate(l[a],i);p(c=>({...c,[a]:t||""}))}},F=a=>{const i=a.target.files?.[0];if(i){R(i);const t=new FileReader;t.onloadend=()=>{L(t.result)},t.readAsDataURL(i)}},E=async(a,i)=>{const t=I(A,`programmers/${a}/profile.jpg`);return await k(t,i),await q(t)},$=async a=>{a.preventDefault();const i=Object.keys(h).reduce((c,g)=>(c[g]=!0,c),{});b(i);const t=n.validateForm(l,h);if(p(t),n.hasErrors(t)){u("Por favor corrige los errores en el formulario.");return}f(!0),u(""),v("");try{let c=l.photoURL;P&&(c=await E(l.uid,P)),await _(l.uid,{displayName:l.displayName,email:l.email,specialty:l.specialty,bio:l.bio,role:"programmer",photoURL:c,socials:{github:l.github||void 0,instagram:l.instagram||void 0,whatsapp:l.whatsapp||void 0}}),v("âœ“ Programador guardado correctamente."),N(U),R(null),L(""),p({}),b({}),await S()}catch{u("No se pudo guardar. Verifica permisos y conexiÃ³n.")}finally{f(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Programadores"}),e.jsx("p",{className:"text-base-content/70",children:"Crea o edita perfiles y asigna el rol de programador."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("form",{onSubmit:$,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("h2",{className:"card-title",children:"Nuevo / editar"}),y&&e.jsx("div",{className:"alert alert-success text-sm",children:y}),w&&e.jsx("div",{className:"alert alert-error text-sm",children:w}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Foto de perfil"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2",children:C||l.photoURL?e.jsx("img",{src:C||l.photoURL,alt:"Preview"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-3xl",children:"ðŸ‘¤"})})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:F,className:"file-input file-input-bordered file-input-sm w-full max-w-xs"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"UID de Firebase *"})}),e.jsx("input",{name:"uid",value:l.uid,onChange:d,onBlur:()=>m("uid"),className:`input input-bordered ${r.uid&&s.uid?"input-error":""}`,placeholder:"UID del usuario autenticado"}),r.uid&&s.uid&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.uid})}),e.jsx("span",{className:"label-text-alt text-base-content/60",children:"Se crea el documento en users con este UID y rol programmer."})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nombre *"})}),e.jsx("input",{name:"displayName",value:l.displayName,onChange:d,onBlur:()=>m("displayName"),className:`input input-bordered ${r.displayName&&s.displayName?"input-error":""}`}),r.displayName&&s.displayName&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.displayName})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Correo *"})}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:d,onBlur:()=>m("email"),className:`input input-bordered ${r.email&&s.email?"input-error":""}`}),r.email&&s.email&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.email})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Especialidad *"})}),e.jsx("input",{name:"specialty",value:l.specialty,onChange:d,onBlur:()=>m("specialty"),className:`input input-bordered ${r.specialty&&s.specialty?"input-error":""}`}),r.specialty&&s.specialty&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.specialty})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Bio"})}),e.jsx("textarea",{name:"bio",value:l.bio,onChange:d,onBlur:()=>m("bio"),className:`textarea textarea-bordered ${r.bio&&s.bio?"textarea-error":""}`,rows:3}),r.bio&&s.bio&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.bio})})]}),e.jsx("div",{className:"divider",children:"Redes Sociales"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"GitHub"})}),e.jsx("input",{name:"github",value:l.github,onChange:d,onBlur:()=>m("github"),className:`input input-bordered ${r.github&&s.github?"input-error":""}`,placeholder:"https://github.com/usuario"}),r.github&&s.github&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.github})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Instagram"})}),e.jsx("input",{name:"instagram",value:l.instagram,onChange:d,onBlur:()=>m("instagram"),className:`input input-bordered ${r.instagram&&s.instagram?"input-error":""}`,placeholder:"https://instagram.com/usuario"}),r.instagram&&s.instagram&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.instagram})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"WhatsApp"})}),e.jsx("input",{name:"whatsapp",value:l.whatsapp,onChange:d,onBlur:()=>m("whatsapp"),className:`input input-bordered ${r.whatsapp&&s.whatsapp?"input-error":""}`,placeholder:"https://wa.me/593988888888"}),r.whatsapp&&s.whatsapp&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.whatsapp})})]}),e.jsx("div",{className:"card-actions justify-end",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:j,children:j?"Guardando...":"Guardar programador"})})]})}),e.jsx("div",{className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:"Listado"}),e.jsx("span",{className:"badge badge-secondary",children:x.length})]}),e.jsxs("div",{className:"space-y-2",children:[x.map(a=>e.jsx("div",{className:"flex flex-col rounded-lg border border-base-200 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-lg",children:"ðŸ‘¤"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold",children:a.displayName}),e.jsx("span",{className:"badge badge-outline capitalize",children:a.specialty||"Especialidad"})]}),e.jsx("p",{className:"text-xs text-base-content/60",children:a.email}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.bio}),a.socials&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.socials.github&&e.jsx("a",{href:a.socials.github,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"GitHub"}),a.socials.instagram&&e.jsx("a",{href:a.socials.instagram,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"Instagram"}),a.socials.whatsapp&&e.jsx("a",{href:a.socials.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"WhatsApp"})]})]})]})},a.id)),!x.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay programadores. Crea uno con el formulario."})]})]})})]})]})};export{z as default};
