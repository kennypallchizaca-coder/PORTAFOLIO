import{u as j,r as t,j as s}from"./index-C7oHUGbv.js";import{j as N,k as f}from"./firestore-BZsbbwbg.js";const k=()=>{const{user:c}=j(),[d,o]=t.useState([]),[n,b]=t.useState(!1),[u,l]=t.useState(""),[a,r]=t.useState("pendiente"),p=()=>{o([])},i=async()=>{if(c?.uid){b(!0),l("");try{const e=await N(c.uid);o(e)}catch{l("No se pudieron cargar las asesorías.")}finally{b(!1)}}};t.useEffect(()=>{i()},[c?.uid]);const m=async(e,h)=>{try{await f(e,h,h==="aprobada"?"Confirmada":"Rechazada"),await i()}catch{l("No se pudo actualizar el estado.")}},x=a==="todas"?d:d.filter(e=>e.status===a);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Asesorías"}),s.jsx("p",{className:"text-base-content/70",children:"Revisa solicitudes y aprueba o rechaza con feedback."})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{className:"btn btn-outline btn-sm",onClick:i,disabled:n,children:"Recargar"}),s.jsx("button",{className:"btn btn-outline btn-sm",onClick:p,disabled:n,children:"Limpiar Historial"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{className:`btn btn-sm ${a==="pendiente"?"btn-primary":"btn-outline"}`,onClick:()=>r("pendiente"),children:"Pendientes"}),s.jsx("button",{className:`btn btn-sm ${a==="aprobada"?"btn-success":"btn-outline"}`,onClick:()=>r("aprobada"),children:"Aprobadas"}),s.jsx("button",{className:`btn btn-sm ${a==="rechazada"?"btn-error":"btn-outline"}`,onClick:()=>r("rechazada"),children:"Rechazadas"}),s.jsx("button",{className:`btn btn-sm ${a==="todas"?"btn-accent":"btn-outline"}`,onClick:()=>r("todas"),children:"Todas"})]}),u&&s.jsx("div",{className:"alert alert-error text-sm",children:u}),n&&s.jsx("div",{className:"skeleton h-20 w-full"}),s.jsxs("div",{className:"space-y-2",children:[x.map(e=>s.jsx("div",{className:"card bg-base-100 shadow-sm",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:e.requesterName}),s.jsx("p",{className:"text-xs text-base-content/60",children:e.requesterEmail})]}),s.jsx("span",{className:"badge badge-outline capitalize",children:e.status})]}),s.jsxs("p",{className:"text-sm",children:["Fecha: ",e.slot?.date," · Hora: ",e.slot?.time]}),s.jsx("p",{className:"text-sm text-base-content/70",children:e.note}),e.status==="pendiente"&&s.jsxs("div",{className:"card-actions justify-end",children:[s.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>m(e.id,"aprobada"),children:"Aprobar"}),s.jsx("button",{className:"btn btn-error btn-sm",onClick:()=>m(e.id,"rechazada"),children:"Rechazar"})]})]})},e.id)),!x.length&&!n&&s.jsxs("div",{className:"alert alert-info text-sm",children:["No hay solicitudes ",a==="todas"?"":a==="pendiente"?"pendientes":`${a}s`,"."]})]})]})};export{k as default};
