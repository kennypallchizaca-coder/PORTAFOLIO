import{r as o,j as e,m as T,n as _,o as J,s as W}from"./index-D9nvKaiz.js";import{a as z,u as K}from"./firestore-CuPlDlB0.js";import{F as c}from"./FormUtils-X4tq9MxD.js";import{v as M,x as O}from"./index-SMITuqPN.js";const E={uid:"",displayName:"",email:"",specialty:"",bio:"",role:"programmer",photoURL:"",github:"",instagram:"",whatsapp:""},Z=()=>{const[r,v]=o.useState(E),[g,$]=o.useState([]),[w,S]=o.useState(!1),[k,C]=o.useState(""),[R,j]=o.useState(""),[P,L]=o.useState(null),[F,U]=o.useState(""),[s,h]=o.useState({}),[i,N]=o.useState({}),[p,x]=o.useState(["JavaScript","React"]),[u,f]=o.useState(""),b={uid:[a=>c.required(a)],displayName:[a=>c.required(a),a=>c.minLength(a,3)],email:[a=>c.required(a),a=>c.email(a)],specialty:[a=>c.required(a),a=>c.minLength(a,3)],bio:[a=>c.minLength(a,10)],github:[a=>a&&c.url(a)],instagram:[a=>a&&c.url(a)],whatsapp:[a=>a&&c.url(a)]},B=async()=>{const a=await z();$(a)};o.useEffect(()=>{B()},[]);const D=()=>{!u.trim()||u.length<2||(x([...p,u.trim()]),f(""))},A=a=>{x(p.filter((t,l)=>l!==a))},d=a=>{const{name:t,value:l}=a.target;if(v(n=>({...n,[t]:l})),i[t]){const n=b[t];if(n){const y=c.validate(l,n);h(G=>({...G,[t]:y||""}))}}},m=a=>{N(l=>({...l,[a]:!0}));const t=b[a];if(t){const l=c.validate(r[a],t);h(n=>({...n,[a]:l||""}))}},H=a=>{const t=a.target.files?.[0];if(t){L(t);const l=new FileReader;l.onloadend=()=>{U(l.result)},l.readAsDataURL(t)}},I=async(a,t)=>{const l=T(W,`programmers/${a}/profile.jpg`);return await _(l,t),await J(l)},q=async a=>{a.preventDefault();const t=Object.keys(b).reduce((n,y)=>(n[y]=!0,n),{});N(t);const l=c.validateForm(r,b);if(h(l),p.length<2&&(l.skills="Debe tener al menos 2 habilidades"),c.hasErrors(l)){j("Por favor corrige los errores en el formulario.");return}S(!0),j(""),C("");try{let n=r.photoURL;P&&(n=await I(r.uid,P)),await K(r.uid,{displayName:r.displayName,email:r.email,specialty:r.specialty,bio:r.bio,role:"programmer",photoURL:n,skills:p,socials:{github:r.github||void 0,instagram:r.instagram||void 0,whatsapp:r.whatsapp||void 0}}),C("âœ“ Programador guardado correctamente."),v(E),x(["JavaScript","React"]),f(""),L(null),U(""),h({}),N({}),await B()}catch{j("No se pudo guardar. Verifica permisos y conexiÃ³n.")}finally{S(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Programadores"}),e.jsx("p",{className:"text-base-content/70",children:"Crea o edita perfiles y asigna el rol de programador."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("form",{onSubmit:q,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("h2",{className:"card-title",children:"Nuevo / editar"}),k&&e.jsx("div",{className:"alert alert-success text-sm",children:k}),R&&e.jsx("div",{className:"alert alert-error text-sm",children:R}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Foto de perfil"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2",children:F||r.photoURL?e.jsx("img",{src:F||r.photoURL,alt:"Preview"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-3xl",children:"ðŸ‘¤"})})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:H,className:"file-input file-input-bordered file-input-sm w-full max-w-xs"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"UID de Firebase *"})}),e.jsx("input",{name:"uid",value:r.uid,onChange:d,onBlur:()=>m("uid"),className:`input input-bordered ${i.uid&&s.uid?"input-error":""}`,placeholder:"UID del usuario autenticado"}),i.uid&&s.uid&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.uid})}),e.jsx("span",{className:"label-text-alt text-base-content/60",children:"Se crea el documento en users con este UID y rol programmer."})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nombre *"})}),e.jsx("input",{name:"displayName",value:r.displayName,onChange:d,onBlur:()=>m("displayName"),className:`input input-bordered ${i.displayName&&s.displayName?"input-error":""}`}),i.displayName&&s.displayName&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.displayName})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Correo *"})}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:d,onBlur:()=>m("email"),className:`input input-bordered ${i.email&&s.email?"input-error":""}`}),i.email&&s.email&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.email})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Especialidad *"})}),e.jsx("input",{name:"specialty",value:r.specialty,onChange:d,onBlur:()=>m("specialty"),className:`input input-bordered ${i.specialty&&s.specialty?"input-error":""}`}),i.specialty&&s.specialty&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.specialty})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Bio"})}),e.jsx("textarea",{name:"bio",value:r.bio,onChange:d,onBlur:()=>m("bio"),className:`textarea textarea-bordered ${i.bio&&s.bio?"textarea-error":""}`,rows:3}),i.bio&&s.bio&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.bio})})]}),e.jsx("div",{className:"divider",children:"Habilidades / Skills"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Habilidades tÃ©cnicas *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:u,onChange:a=>f(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),D())},className:"input input-bordered join-item flex-1",placeholder:"Agregar habilidad (ej: TypeScript, Node.js)"}),e.jsxs("button",{type:"button",onClick:D,className:"btn btn-primary join-item",children:[e.jsx(M,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[p.map((a,t)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:a,onChange:l=>{const n=[...p];n[t]=l.target.value,x(n)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>A(t),className:"btn btn-error join-item",children:[e.jsx(O,{})," Eliminar"]})]},t)),p.length<2&&e.jsx("div",{className:"alert alert-warning text-sm",children:"Debe agregar al menos 2 habilidades"})]})]}),e.jsx("div",{className:"divider",children:"Redes Sociales"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"GitHub"})}),e.jsx("input",{name:"github",value:r.github,onChange:d,onBlur:()=>m("github"),className:`input input-bordered ${i.github&&s.github?"input-error":""}`,placeholder:"https://github.com/usuario"}),i.github&&s.github&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.github})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Instagram"})}),e.jsx("input",{name:"instagram",value:r.instagram,onChange:d,onBlur:()=>m("instagram"),className:`input input-bordered ${i.instagram&&s.instagram?"input-error":""}`,placeholder:"https://instagram.com/usuario"}),i.instagram&&s.instagram&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.instagram})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"WhatsApp"})}),e.jsx("input",{name:"whatsapp",value:r.whatsapp,onChange:d,onBlur:()=>m("whatsapp"),className:`input input-bordered ${i.whatsapp&&s.whatsapp?"input-error":""}`,placeholder:"https://wa.me/593988888888"}),i.whatsapp&&s.whatsapp&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:s.whatsapp})})]}),e.jsx("div",{className:"card-actions justify-end",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:w,children:w?"Guardando...":"Guardar programador"})})]})}),e.jsx("div",{className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:"Listado"}),e.jsx("span",{className:"badge badge-secondary",children:g.length})]}),e.jsxs("div",{className:"space-y-2",children:[g.map(a=>e.jsx("div",{className:"flex flex-col rounded-lg border border-base-200 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-lg",children:"ðŸ‘¤"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold",children:a.displayName}),e.jsx("span",{className:"badge badge-outline capitalize",children:a.specialty||"Especialidad"})]}),e.jsx("p",{className:"text-xs text-base-content/60",children:a.email}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.bio}),a.skills&&a.skills.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-semibold text-base-content/70 mb-1",children:"Habilidades:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.skills.map((t,l)=>e.jsx("span",{className:"badge badge-primary badge-sm",children:t},l))})]}),a.socials&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.socials.github&&e.jsx("a",{href:a.socials.github,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"GitHub"}),a.socials.instagram&&e.jsx("a",{href:a.socials.instagram,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"Instagram"}),a.socials.whatsapp&&e.jsx("a",{href:a.socials.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"WhatsApp"})]})]})]})},a.id)),!g.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay programadores. Crea uno con el formulario."})]})]})})]})]})};export{Z as default};
