import{r as c,j as e}from"./index-BVC0icWY.js";import{a as ee,u as ae,d as se}from"./firestore-DeDfMWJn.js";import{F as o}from"./FormUtils-X4tq9MxD.js";import{w as M,y as A,A as le}from"./index-GXs0CitT.js";const B={displayName:"",email:"",specialty:"",bio:"",role:"programmer",photoURL:"",github:"",instagram:"",whatsapp:"",available:!1},ce=()=>{const[t,j]=c.useState(B),[E,W]=c.useState([]),[T,_]=c.useState(!1),[H,P]=c.useState(""),[I,w]=c.useState(""),[G,L]=c.useState(null),[J,v]=c.useState(""),[r,b]=c.useState({}),[n,N]=c.useState({}),[f,F]=c.useState(null),[d,x]=c.useState(["JavaScript","React"]),[S,k]=c.useState(""),[m,u]=c.useState(["09:00","11:00"]),[C,U]=c.useState(""),R={displayName:[a=>o.required(a),a=>o.minLength(a,3)],email:[a=>o.required(a),a=>o.email(a)],specialty:[a=>o.required(a),a=>o.minLength(a,3)],bio:[a=>o.minLength(a,10)],github:[a=>a&&o.url(a)],instagram:[a=>a&&o.url(a)],whatsapp:[a=>a&&o.url(a)]},D=async()=>{const a=await ee();W(a)};c.useEffect(()=>{D()},[]);const q=()=>{!S.trim()||S.length<2||(x([...d,S.trim()]),k(""))},K=a=>{x(d.filter((s,l)=>l!==a))},p=a=>{const{name:s,value:l}=a.target;if(j(i=>({...i,[s]:l})),n[s]){const i=R[s];if(i){const y=o.validate(l,i);b(g=>({...g,[s]:y||""}))}}},h=a=>{N(l=>({...l,[a]:!0}));const s=R[a];if(s){const l=o.validate(t[a],s);b(i=>({...i,[a]:l||""}))}},O=a=>{const s=a.target.files?.[0];if(s){L(s);const l=new FileReader;l.onloadend=()=>{v(l.result)},l.readAsDataURL(s)}},V=async a=>{a.preventDefault();const s=Object.keys(R).reduce((i,y)=>(i[y]=!0,i),{});N(s);const l=o.validateForm(t,R);if(b(l),d.length<2&&(l.skills="Debe tener al menos 2 habilidades"),t.available&&m.length===0&&(l.schedule="Debe especificar al menos un horario si estÃ¡ disponible"),o.hasErrors(l)){w("Por favor corrige los errores en el formulario.");return}_(!0),w(""),P("");try{const i=f||`prog_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;let y=t.photoURL;if(G){const $=new FileReader;y=await new Promise(Z=>{$.onloadend=()=>{const z=$.result;localStorage.setItem(`photo_${i}`,z),Z(z)},$.readAsDataURL(G)})}const g={};t.github&&(g.github=t.github),t.instagram&&(g.instagram=t.instagram),t.whatsapp&&(g.whatsapp=t.whatsapp),await ae(i,{displayName:t.displayName,email:t.email,specialty:t.specialty,bio:t.bio,role:"programmer",photoURL:"",skills:d,socials:g,available:t.available,schedule:m}),P(f?"âœ“ Programador actualizado correctamente.":"âœ“ Programador guardado correctamente."),j(B),x(["JavaScript","React"]),k(""),u(["09:00","11:00"]),U(""),L(null),v(""),b({}),N({}),F(null),await D()}catch(i){console.error("Error al guardar programador:",i),w(`Error al guardar: ${i.message||"Verifica permisos de Firebase"}`)}finally{_(!1)}},Q=a=>{F(a.id),j({displayName:a.displayName||"",email:a.email||"",specialty:a.specialty||"",bio:a.bio||"",role:"programmer",photoURL:a.photoURL||"",github:a.socials?.github||"",instagram:a.socials?.instagram||"",whatsapp:a.socials?.whatsapp||"",available:a.available??!1}),u(a.schedule||["09:00","11:00"]),x(a.skills||["JavaScript","React"]),v(a.photoURL||""),b({}),N({}),window.scrollTo({top:0,behavior:"smooth"})},X=async(a,s)=>{if(confirm(`Â¿EstÃ¡s seguro de eliminar a ${s}?`))try{await se(a),P(`âœ“ ${s} eliminado correctamente.`),await D()}catch{w("No se pudo eliminar el programador.")}},Y=()=>{F(null),j(B),x(["JavaScript","React"]),k(""),L(null),v(""),b({}),N({})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Programadores"}),e.jsx("p",{className:"text-base-content/70",children:"Crea o edita perfiles y asigna el rol de programador."})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("form",{onSubmit:V,className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("h2",{className:"card-title",children:f?"Editar programador":"Nuevo programador"}),H&&e.jsx("div",{className:"alert alert-success text-sm",children:H}),I&&e.jsx("div",{className:"alert alert-error text-sm",children:I}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Foto de perfil"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2",children:J||t.photoURL?e.jsx("img",{src:J||t.photoURL,alt:"Preview"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-3xl",children:"ðŸ‘¤"})})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:O,className:"file-input file-input-bordered file-input-sm w-full max-w-xs"})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nombre *"})}),e.jsx("input",{name:"displayName",value:t.displayName,onChange:p,onBlur:()=>h("displayName"),className:`input input-bordered ${n.displayName&&r.displayName?"input-error":""}`}),n.displayName&&r.displayName&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.displayName})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Correo *"})}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:p,onBlur:()=>h("email"),className:`input input-bordered ${n.email&&r.email?"input-error":""}`}),n.email&&r.email&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.email})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Especialidad *"})}),e.jsx("input",{name:"specialty",value:t.specialty,onChange:p,onBlur:()=>h("specialty"),className:`input input-bordered ${n.specialty&&r.specialty?"input-error":""}`}),n.specialty&&r.specialty&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.specialty})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Bio"})}),e.jsx("textarea",{name:"bio",value:t.bio,onChange:p,onBlur:()=>h("bio"),className:`textarea textarea-bordered ${n.bio&&r.bio?"textarea-error":""}`,rows:3}),n.bio&&r.bio&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.bio})})]}),e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer",children:[e.jsx("span",{className:"label-text",children:"Disponible para asesorÃ­as"}),e.jsx("input",{type:"checkbox",checked:t.available,onChange:a=>{const s=a.target.checked;j(l=>({...l,available:s})),u(s?m:[])},className:"toggle toggle-primary"})]})}),t.available&&e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Horarios de disponibilidad *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"time",value:C,onChange:a=>U(a.target.value),className:"input input-bordered join-item",placeholder:"Selecciona hora"}),e.jsxs("button",{type:"button",onClick:()=>{C&&!m.includes(C)&&(u([...m,C]),U(""))},className:"btn btn-primary join-item",children:[e.jsx(M,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[m.map((a,s)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"time",value:a,onChange:l=>{const i=[...m];i[s]=l.target.value,u(i)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>u(m.filter((l,i)=>i!==s)),className:"btn btn-error join-item",children:[e.jsx(A,{})," Eliminar"]})]},s)),m.length===0&&e.jsx("div",{className:"alert alert-warning",children:"Debe agregar al menos 1 horario"})]}),r.schedule&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.schedule})})]}),e.jsx("div",{className:"divider",children:"Habilidades / Skills"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-bold",children:"Habilidades tÃ©cnicas *"})}),e.jsxs("div",{className:"join mb-3",children:[e.jsx("input",{type:"text",value:S,onChange:a=>k(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),q())},className:"input input-bordered join-item flex-1",placeholder:"Agregar habilidad (ej: TypeScript, Node.js)"}),e.jsxs("button",{type:"button",onClick:q,className:"btn btn-primary join-item",children:[e.jsx(M,{})," Agregar"]})]}),e.jsxs("div",{className:"space-y-2",children:[d.map((a,s)=>e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"text",value:a,onChange:l=>{const i=[...d];i[s]=l.target.value,x(i)},className:"input input-bordered join-item flex-1"}),e.jsxs("button",{type:"button",onClick:()=>K(s),className:"btn btn-error join-item",children:[e.jsx(A,{})," Eliminar"]})]},s)),d.length<2&&e.jsx("div",{className:"alert alert-warning text-sm",children:"Debe agregar al menos 2 habilidades"})]})]}),e.jsx("div",{className:"divider",children:"Redes Sociales"}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"GitHub"})}),e.jsx("input",{name:"github",value:t.github,onChange:p,onBlur:()=>h("github"),className:`input input-bordered ${n.github&&r.github?"input-error":""}`,placeholder:"https://github.com/usuario"}),n.github&&r.github&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.github})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Instagram"})}),e.jsx("input",{name:"instagram",value:t.instagram,onChange:p,onBlur:()=>h("instagram"),className:`input input-bordered ${n.instagram&&r.instagram?"input-error":""}`,placeholder:"https://instagram.com/usuario"}),n.instagram&&r.instagram&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.instagram})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"WhatsApp"})}),e.jsx("input",{name:"whatsapp",value:t.whatsapp,onChange:p,onBlur:()=>h("whatsapp"),className:`input input-bordered ${n.whatsapp&&r.whatsapp?"input-error":""}`,placeholder:"https://wa.me/593988888888"}),n.whatsapp&&r.whatsapp&&e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt text-error",children:r.whatsapp})})]}),e.jsxs("div",{className:"card-actions justify-end gap-2",children:[f&&e.jsx("button",{className:"btn btn-ghost",type:"button",onClick:Y,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:T,children:T?"Guardando...":f?"Actualizar":"Guardar programador"})]})]})}),e.jsx("div",{className:"card bg-base-100 shadow-md",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"card-title",children:"Listado"}),e.jsx("span",{className:"badge badge-secondary",children:E.length})]}),e.jsxs("div",{className:"space-y-2",children:[E.map(a=>e.jsx("div",{className:"flex flex-col rounded-lg border border-base-200 p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-base-300",children:e.jsx("span",{className:"text-lg",children:"ðŸ‘¤"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold",children:a.displayName}),e.jsx("span",{className:"badge badge-outline capitalize",children:a.specialty||"Especialidad"})]}),e.jsx("p",{className:"text-xs text-base-content/60",children:a.email}),e.jsx("p",{className:"text-sm text-base-content/70",children:a.bio}),a.skills&&a.skills.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-semibold text-base-content/70 mb-1",children:"Habilidades:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.skills.map((s,l)=>e.jsx("span",{className:"badge badge-primary badge-sm",children:s},l))})]}),a.socials&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[a.socials.github&&e.jsx("a",{href:a.socials.github,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"GitHub"}),a.socials.instagram&&e.jsx("a",{href:a.socials.instagram,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"Instagram"}),a.socials.whatsapp&&e.jsx("a",{href:a.socials.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"badge badge-ghost badge-sm",children:"WhatsApp"})]}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("button",{onClick:()=>Q(a),className:"btn btn-sm btn-primary gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>X(a.id,a.displayName),className:"btn btn-sm btn-error gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Eliminar"]})]})]})]})},a.id)),!E.length&&e.jsx("div",{className:"alert alert-info text-sm",children:"AÃºn no hay programadores. Crea uno con el formulario."})]})]})})]})]})};export{ce as default};
